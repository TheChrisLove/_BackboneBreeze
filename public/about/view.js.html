<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Source: base/view.js</title>
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="keyword" content="" />
    <meta property="og:title" content=""/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content=""/>
    <meta property="og:site_name" content=""/>
    <meta property="og:url" content=""/>
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jaguar.css">
    
    
    <script>
    var config = {"monospaceLinks":true,"cleverLinks":true,"default":{"outputSourceFiles":true},"applicationName":"ESS.App","disqus":"","googleAnalytics":"","openGraph":{"title":"","type":"website","image":"","site_name":"","url":""},"meta":{"title":"","description":"","keyword":""}};
    </script>
    

    
</head>
<body>
<div id="wrap" class="clearfix">
    
<div class="navigation">
    <h3 class="applicationName"><a href="index.html">ESS.App</a></h3>

    <div class="search">
        <input id="search" type="text" class="form-control input-sm" placeholder="Search Documentations">
    </div>
    <ul class="list">
    
        <li class="item" data-name="App">
            <span class="title">
                <a href="App.html">App</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="BaseView">
            <span class="title">
                <a href="BaseView.html">BaseView</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="BaseView#_applyModelListeners"><a href="BaseView.html#_applyModelListeners">_applyModelListeners</a></li>
            
                <li data-name="BaseView#_breezeCallback"><a href="BaseView.html#_breezeCallback">_breezeCallback</a></li>
            
                <li data-name="BaseView#_contextModelListen"><a href="BaseView.html#_contextModelListen">_contextModelListen</a></li>
            
                <li data-name="BaseView#_createViewModel"><a href="BaseView.html#_createViewModel">_createViewModel</a></li>
            
                <li data-name="BaseView#_createViewModelHelper"><a href="BaseView.html#_createViewModelHelper">_createViewModelHelper</a></li>
            
                <li data-name="BaseView#_getAddress"><a href="BaseView.html#_getAddress">_getAddress</a></li>
            
                <li data-name="BaseView#_updateContextModel"><a href="BaseView.html#_updateContextModel">_updateContextModel</a></li>
            
                <li data-name="BaseView#afterRender"><a href="BaseView.html#afterRender">afterRender</a></li>
            
                <li data-name="BaseView#beforeRender"><a href="BaseView.html#beforeRender">beforeRender</a></li>
            
                <li data-name="BaseView#createViewModel"><a href="BaseView.html#createViewModel">createViewModel</a></li>
            
                <li data-name="BaseView#dispose"><a href="BaseView.html#dispose">dispose</a></li>
            
                <li data-name="BaseView#fetchTemplate"><a href="BaseView.html#fetchTemplate">fetchTemplate</a></li>
            
                <li data-name="BaseView#getViewModel"><a href="BaseView.html#getViewModel">getViewModel</a></li>
            
                <li data-name="BaseView#renderBindings"><a href="BaseView.html#renderBindings">renderBindings</a></li>
            
                <li data-name="BaseView#renderComplete"><a href="BaseView.html#renderComplete">renderComplete</a></li>
            
                <li data-name="BaseView#resetBindings"><a href="BaseView.html#resetBindings">resetBindings</a></li>
            
                <li data-name="BaseView#resetElement"><a href="BaseView.html#resetElement">resetElement</a></li>
            
                <li data-name="BaseView#setModel"><a href="BaseView.html#setModel">setModel</a></li>
            
                <li data-name="BaseView#setViewModel"><a href="BaseView.html#setViewModel">setViewModel</a></li>
            
                <li data-name="BaseView#start"><a href="BaseView.html#start">start</a></li>
            
                <li data-name="BaseView#subscribe"><a href="BaseView.html#subscribe">subscribe</a></li>
            
                <li data-name="BaseView#trackValidation"><a href="BaseView.html#trackValidation">trackValidation</a></li>
            
                <li data-name="BaseView#updateViewModel"><a href="BaseView.html#updateViewModel">updateViewModel</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Controller">
            <span class="title">
                <a href="Controller.html">Controller</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Controller#_prepActions"><a href="Controller.html#_prepActions">_prepActions</a></li>
            
                <li data-name="Controller#buildMenuActions"><a href="Controller.html#buildMenuActions">buildMenuActions</a></li>
            
                <li data-name="Controller#dispose"><a href="Controller.html#dispose">dispose</a></li>
            
                <li data-name="Controller#getView"><a href="Controller.html#getView">getView</a></li>
            
                <li data-name="Controller#renderLayout"><a href="Controller.html#renderLayout">renderLayout</a></li>
            
                <li data-name="Controller#setView"><a href="Controller.html#setView">setView</a></li>
            
                <li data-name="Controller#start"><a href="Controller.html#start">start</a></li>
            
                <li data-name="Controller#startAction"><a href="Controller.html#startAction">startAction</a></li>
            
                <li data-name="Controller#verifyAction"><a href="Controller.html#verifyAction">verifyAction</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="DataService">
            <span class="title">
                <a href="DataService.html">DataService</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="DataService~queryFailed"><a href="DataService.html#queryFailed">queryFailed</a></li>
            
                <li data-name="DataService~querySucceeded"><a href="DataService.html#querySucceeded">querySucceeded</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="DataService#_filterByLocation"><a href="DataService.html#_filterByLocation">_filterByLocation</a></li>
            
                <li data-name="DataService#applyPredicate"><a href="DataService.html#applyPredicate">applyPredicate</a></li>
            
                <li data-name="DataService#get"><a href="DataService.html#get">get</a></li>
            
                <li data-name="DataService#getChildCollection"><a href="DataService.html#getChildCollection">getChildCollection</a></li>
            
                <li data-name="DataService#getCollection"><a href="DataService.html#getCollection">getCollection</a></li>
            
                <li data-name="DataService#getEntityInfo"><a href="DataService.html#getEntityInfo">getEntityInfo</a></li>
            
                <li data-name="DataService#getEntityName"><a href="DataService.html#getEntityName">getEntityName</a></li>
            
                <li data-name="DataService#getEntityTypeByResource"><a href="DataService.html#getEntityTypeByResource">getEntityTypeByResource</a></li>
            
                <li data-name="DataService#getErrorMessage"><a href="DataService.html#getErrorMessage">getErrorMessage</a></li>
            
                <li data-name="DataService#getLocationCollection"><a href="DataService.html#getLocationCollection">getLocationCollection</a></li>
            
                <li data-name="DataService#getMessageFromEntityError"><a href="DataService.html#getMessageFromEntityError">getMessageFromEntityError</a></li>
            
                <li data-name="DataService#getValidationMessages"><a href="DataService.html#getValidationMessages">getValidationMessages</a></li>
            
                <li data-name="DataService#subscribe"><a href="DataService.html#subscribe">subscribe</a></li>
            
                <li data-name="DataService#validatePredicate"><a href="DataService.html#validatePredicate">validatePredicate</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Grid">
            <span class="title">
                <a href="Grid.html">Grid</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Grid#_afterRender"><a href="Grid.html#_afterRender">_afterRender</a></li>
            
                <li data-name="Grid#_applyFilter"><a href="Grid.html#_applyFilter">_applyFilter</a></li>
            
                <li data-name="Grid#_assemblePredicate"><a href="Grid.html#_assemblePredicate">_assemblePredicate</a></li>
            
                <li data-name="Grid#_buildColumns"><a href="Grid.html#_buildColumns">_buildColumns</a></li>
            
                <li data-name="Grid#_buildLayout"><a href="Grid.html#_buildLayout">_buildLayout</a></li>
            
                <li data-name="Grid#_buildViewModel"><a href="Grid.html#_buildViewModel">_buildViewModel</a></li>
            
                <li data-name="Grid#_fetch"><a href="Grid.html#_fetch">_fetch</a></li>
            
                <li data-name="Grid#_filter"><a href="Grid.html#_filter">_filter</a></li>
            
                <li data-name="Grid#_getDataType"><a href="Grid.html#_getDataType">_getDataType</a></li>
            
                <li data-name="Grid#_getEntityInfo"><a href="Grid.html#_getEntityInfo">_getEntityInfo</a></li>
            
                <li data-name="Grid#_loadEntityData"><a href="Grid.html#_loadEntityData">_loadEntityData</a></li>
            
                <li data-name="Grid#_predicateFilter"><a href="Grid.html#_predicateFilter">_predicateFilter</a></li>
            
                <li data-name="Grid#_sortEngine"><a href="Grid.html#_sortEngine">_sortEngine</a></li>
            
                <li data-name="Grid#_sortHandler"><a href="Grid.html#_sortHandler">_sortHandler</a></li>
            
                <li data-name="Grid#_updateCollections"><a href="Grid.html#_updateCollections">_updateCollections</a></li>
            
                <li data-name="Grid#addColumns"><a href="Grid.html#addColumns">addColumns</a></li>
            
                <li data-name="Grid#dispose"><a href="Grid.html#dispose">dispose</a></li>
            
                <li data-name="Grid#filter"><a href="Grid.html#filter">filter</a></li>
            
                <li data-name="Grid#getSelected"><a href="Grid.html#getSelected">getSelected</a></li>
            
                <li data-name="Grid#getView"><a href="Grid.html#getView">getView</a></li>
            
                <li data-name="Grid#getViewModel"><a href="Grid.html#getViewModel">getViewModel</a></li>
            
                <li data-name="Grid#removeColumns"><a href="Grid.html#removeColumns">removeColumns</a></li>
            
                <li data-name="Grid#removeFilter"><a href="Grid.html#removeFilter">removeFilter</a></li>
            
                <li data-name="Grid#render"><a href="Grid.html#render">render</a></li>
            
                <li data-name="Grid#setSelected"><a href="Grid.html#setSelected">setSelected</a></li>
            
                <li data-name="Grid#updateViewModels"><a href="Grid.html#updateViewModels">updateViewModels</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            <span class="subtitle">Events</span>
            
                <li data-name="Grid#event:hasData"><a href="Grid.html#event:hasData">hasData</a></li>
            
            </ul>
        </li>
    
        <li class="item" data-name="Info">
            <span class="title">
                <a href="Info.html">Info</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Info#applyClaimsAccess"><a href="Info.html#applyClaimsAccess">applyClaimsAccess</a></li>
            
                <li data-name="Info#cleanViews"><a href="Info.html#cleanViews">cleanViews</a></li>
            
                <li data-name="Info#getActive"><a href="Info.html#getActive">getActive</a></li>
            
                <li data-name="Info#getController"><a href="Info.html#getController">getController</a></li>
            
                <li data-name="Info#getModule"><a href="Info.html#getModule">getModule</a></li>
            
                <li data-name="Info#recycle"><a href="Info.html#recycle">recycle</a></li>
            
                <li data-name="Info#renderModule"><a href="Info.html#renderModule">renderModule</a></li>
            
                <li data-name="Info#setActive"><a href="Info.html#setActive">setActive</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="KnockoutBindings">
            <span class="title">
                <a href="KnockoutBindings.html">KnockoutBindings</a>
                
            </span>
            <ul class="members itemMembers">
            
            <span class="subtitle">Members</span>
            
                <li data-name="KnockoutBindings._this.bootstrapGrid"><a href="KnockoutBindings.html#_this.bootstrapGrid">_this.bootstrapGrid</a></li>
            
                <li data-name="KnockoutBindings._this.locationBreadcrumbs"><a href="KnockoutBindings.html#_this.locationBreadcrumbs">_this.locationBreadcrumbs</a></li>
            
                <li data-name="KnockoutBindings._this.subNav"><a href="KnockoutBindings.html#_this.subNav">_this.subNav</a></li>
            
                <li data-name="KnockoutBindings._this.urlArgs"><a href="KnockoutBindings.html#_this.urlArgs">_this.urlArgs</a></li>
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Location">
            <span class="title">
                <a href="Location.html">Location</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Location#_buildCrumbs"><a href="Location.html#_buildCrumbs">_buildCrumbs</a></li>
            
                <li data-name="Location#setActive"><a href="Location.html#setActive">setActive</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            <span class="subtitle">Events</span>
            
                <li data-name="Location#location:change"><a href="Location.html#event:location:change">location:change</a></li>
            
            </ul>
        </li>
    
        <li class="item" data-name="Modal">
            <span class="title">
                <a href="Modal.html">Modal</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Modal#_buttonClick"><a href="Modal.html#_buttonClick">_buttonClick</a></li>
            
                <li data-name="Modal#_modalOnClose"><a href="Modal.html#_modalOnClose">_modalOnClose</a></li>
            
                <li data-name="Modal#close"><a href="Modal.html#close">close</a></li>
            
                <li data-name="Modal#renderComplete"><a href="Modal.html#renderComplete">renderComplete</a></li>
            
                <li data-name="Modal#setContentView"><a href="Modal.html#setContentView">setContentView</a></li>
            
                <li data-name="Modal#show"><a href="Modal.html#show">show</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="QueueService">
            <span class="title">
                <a href="QueueService.html">QueueService</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="QueueService#_error"><a href="QueueService.html#_error">_error</a></li>
            
                <li data-name="QueueService#_success"><a href="QueueService.html#_success">_success</a></li>
            
                <li data-name="QueueService#callApiMethod"><a href="QueueService.html#callApiMethod">callApiMethod</a></li>
            
                <li data-name="QueueService#CallNextForService"><a href="QueueService.html#CallNextForService">CallNextForService</a></li>
            
                <li data-name="QueueService#CallTicket"><a href="QueueService.html#CallTicket">CallTicket</a></li>
            
                <li data-name="QueueService#CancelTicket"><a href="QueueService.html#CancelTicket">CancelTicket</a></li>
            
                <li data-name="QueueService#CompleteTicket"><a href="QueueService.html#CompleteTicket">CompleteTicket</a></li>
            
                <li data-name="QueueService#GetCurrentInService"><a href="QueueService.html#GetCurrentInService">GetCurrentInService</a></li>
            
                <li data-name="QueueService#GetWaitList"><a href="QueueService.html#GetWaitList">GetWaitList</a></li>
            
                <li data-name="QueueService#HoldTicket"><a href="QueueService.html#HoldTicket">HoldTicket</a></li>
            
                <li data-name="QueueService#MoveTicketToWait"><a href="QueueService.html#MoveTicketToWait">MoveTicketToWait</a></li>
            
                <li data-name="QueueService#PauseTicket"><a href="QueueService.html#PauseTicket">PauseTicket</a></li>
            
                <li data-name="QueueService#UpdateService"><a href="QueueService.html#UpdateService">UpdateService</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="Router">
            <span class="title">
                <a href="Router.html">Router</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Router#_getActiveLayout"><a href="Router.html#_getActiveLayout">_getActiveLayout</a></li>
            
                <li data-name="Router#_getArgs"><a href="Router.html#_getArgs">_getArgs</a></li>
            
                <li data-name="Router#_setLayout"><a href="Router.html#_setLayout">_setLayout</a></li>
            
                <li data-name="Router#default"><a href="Router.html#default">default</a></li>
            
                <li data-name="Router#go"><a href="Router.html#go">go</a></li>
            
                <li data-name="Router#login"><a href="Router.html#login">login</a></li>
            
                <li data-name="Router#show404"><a href="Router.html#show404">show404</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
        <li class="item" data-name="User">
            <span class="title">
                <a href="User.html">User</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="User#IsTopLevelLocationDeleted"><a href="User.html#IsTopLevelLocationDeleted">IsTopLevelLocationDeleted</a></li>
            
                <li data-name="User#login"><a href="User.html#login">login</a></li>
            
                <li data-name="User#loginSuccess"><a href="User.html#loginSuccess">loginSuccess</a></li>
            
                <li data-name="User#logout"><a href="User.html#logout">logout</a></li>
            
                <li data-name="User#verify"><a href="User.html#verify">verify</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            <span class="subtitle">Events</span>
            
                <li data-name="User#user:login"><a href="User.html#event:user:login">user:login</a></li>
            
                <li data-name="User#user:logout"><a href="User.html#event:user:logout">user:logout</a></li>
            
            </ul>
        </li>
    
        <li class="item" data-name="Utils">
            <span class="title">
                <a href="Utils.html">Utils</a>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="Utils#formatDate"><a href="Utils.html#formatDate">formatDate</a></li>
            
                <li data-name="Utils#formatDateTime"><a href="Utils.html#formatDateTime">formatDateTime</a></li>
            
                <li data-name="Utils#formatTime"><a href="Utils.html#formatTime">formatTime</a></li>
            
                <li data-name="Utils#getForm"><a href="Utils.html#getForm">getForm</a></li>
            
                <li data-name="Utils#hoursMinutes"><a href="Utils.html#hoursMinutes">hoursMinutes</a></li>
            
                <li data-name="Utils#trackedBreezeCollection"><a href="Utils.html#trackedBreezeCollection">trackedBreezeCollection</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
    </ul>
</div>
    <div class="main">
        <h1 class="page-title" data-filename="view.js.html">Source: base/view.js</h1>
        


    
    <section>
        <article>
            <pre class="prettyprint source"><code>/* global define, app, console, $ */
define([
    'underscore',
    'backbone',
    'knockback',
    'knockout',
    'lib/vmUtils',
    'layoutmanager'
], function(_, Backbone, kb, ko, vmUtils) {
    "use strict";

    var BaseView = Backbone.Layout.extend( /** @lends BaseView.prototype */ {
        /**
         * @class BaseView Base view that handles the relationships between knockout/knockback/backbone
         * and in some cases Breeze.  Use as a base and overwrite/extend as needed.
         *
         * @augments Backbone.View
         * @constructs
         * @requires Backbone
         * @param {object} options - Backbone.View options
         *
         * @property {boolean} kobBindingsApplied - If KO bindings have been applied
         * @property {object|Function} [vm_model_context] - An object or function returning an object which is a nested property on this.model to be used
         * as the basis for creating this viewModel.
         * @property {object} [vm_model_context_options] - Options relating to creation of vm_context_model
         * @property {array} [vm_model_context_options.related] - References to related models to be tracked by this.vm_context_model
         * @property {Model} [vm_context_model] - Backbone.Model created during _creatViewModel if this.vm_model_context exists.
         * Scopes in the context of the viewModel.
         * @property {string} [address] - If model is a nested model, and using context model functionality, address tracks path to context model on parent model
         * @property {object} [breezeQuery] - A breeze query to be applied, the resulting model will be used on the view.
         * @property {array} [_modelListeners] - An array of subscriptions to be applied to this.model
         * @property {string} [_modelListeners.eventType] - Backbone event type
         * @property {string} [_modelListeners.trigger] - Backbone trigger type
         * @property {Function} [_modelListeners.callback] - Callback to fire when triggered
         * @property {object} [_modelListeners.context] - Context to apply to the callback
         */
        initialize: function(options) {
            _.bindAll(this, 'createViewModel', '_createViewModel', '_createViewModelHelper',
                'setViewModel', 'updateViewModel', 'getViewModel',
                '_updateContextModel', '_contextModelListen', '_getAddress',
                'setModel', '_breezeCallback', '_applyModelListeners',
                'resetBindings', 'renderBindings', 'cleanup',
                'trackValidation', 'renderComplete', 'start');

            this.utils = new vmUtils();

            // Setup a tracker for whether or not ko bindings have been applied,
            // they can only be applied once or they throw an error.
            this.koBindingsApplied = false;

            // Post 'initialization'. 
            this.start(options);

            if (this.model) {
                // If model is not a properly setup backbone model, set it up
                if (!this.model.on) this.model = new Backbone.Model(this.model);

                // Setup any listeners being passed in
                if (options &amp;&amp; options._modelListeners) {
                    this._modelListeners = options._modelListeners;
                    this._applyModelListeners();
                }

                // When the model syncs, we want to updat the view model and 
                // force a new render in order to ensure viewModel bindings are updated.
                this.model.on('sync', function() {
                    this.updateViewModel(true);
                }, this);
            }

            // ViewModel Creation
            // ------------------

            // Setup the viewModel
            this.setViewModel(options);

            // Breeze Integration
            // ------------------

            // Use breezeQuery if you want to dynamically grab an entity for the view.
            // This view will sync/create view model when the breeze query resolves.

            // breezeQuery is not a standard option, but this allows us to treat it like one!
            if (options &amp;&amp; options.breezeQuery) this.breezeQuery = options.breezeQuery;
            if (this.breezeQuery) {
                // You WILL get a console error when the view first resolves though.
                // TODO : update how bindings render to defer until callback. (to avoid console error)
                app.api.get(this.breezeQuery, {
                    callback: this._breezeCallback
                });
            }

        },

        _modelListeners: [],

        /**
         * Empty start function.  Intended to be overriden for custom logics when extending this View
         * @param {object} options - Same options passed into this.initialize
         */
        start: function(options) {},

        // View API
        // --------

        cleanup: function(args) {
            this.$el.find("*").each(function() {
                $(this).unbind();
            });

            // TODO check this to happen automatically on removal, check nested layouts

            //if(this.viewModel) kb.releaseOnNodeRemove(this.viewModel, this.$el);
            // Remove KO subscriptions and references
            ko.removeNode(this.$el[0]);
            delete this.viewModel;
        },

        /**
         * Removes the view from dom, cleans up ko bindings and event bindings
         */
        dispose: function() {
            this.$el.find("*").each(function() {
                $(this).unbind();
            });

            // TODO check this to happen automatically on removal, check nested layouts

            //if(this.viewModel) kb.releaseOnNodeRemove(this.viewModel, this.$el);
            // Remove KO subscriptions and references
            ko.removeNode(this.$el[0]);

            var test;
            delete this.viewModel;

            this.remove();
        },

        /**
         * Getter/Initializer for viewModel.  Will return this viewmodel (if this.viewModel has not
         * yet been created, it will be created and returned)
         * @returns {object} ViewModel utilized by this view.
         */
        getViewModel: function() {
            return (!this.viewModel) ? this.createViewModel(this.options) : this.viewModel;
        },

        /**
         * Re-sets this view to the DOM. If a view is persisted, re-rendering the view can break bindings
         * unless the view $el is updated to be associated with its new DOM parent.
         * @param {object} element - jQuery Object referencing parent node to set this view on
         */
        resetElement: function(element) {
            var reset = $('&lt;' + ((this.tagName) ? this.tagName : 'div') + '>');
            if (this.className) reset.addClass(this.className);
            element = element instanceof Backbone.$ ? element : Backbone.$(element);
            element.append(reset);
            this.setElement(reset);
        },

        /**
         * Setup a subscription to an event occurring on this.model.
         * Can be called in advance of setting up a model on the view.
         *
         * @param {string} eventType - Backbone event type
         * @param {string} trigger - Backbone event trigger type
         * @param {Function} callback - Callback to fire on event trigger
         * @param {object} context - Context within which to fire callback
         */
        subscribe: function(eventType, trigger, callback, context) {
            if (this.model) this.model[eventType](trigger, callback, context);
            else this._modelListeners.push({
                eventType: eventType,
                trigger: trigger,
                callback: callback,
                context: context
            });
        },

        /**
         * Set a model (or new model) on this view.  Destroys existing model, sets up subscriptions, and re-creates the viewModel.
         * @returns {View} This view.
         * @param {Model} model - Backbone.Model to set on this view
         * @param {Function} callback - callback to fire after model has been applied.
         */
        setModel: function(model, callback) {
            this.model.destroy();
            this.model = model;
            this.setViewModel();
            this._applyModelListeners();
            this.model.on('sync', function() {
                this.updateViewModel(true);
            });
            if (callback) callback();
            return this;
        },

        /**
         * Triggers an update of the viewModel.
         * @param {boolean} render - If true, a re-render of the view will be forced.
         */
        updateViewModel: function(render) {
            this.setViewModel();
            return (render) ? this.render() : true;
        },

        /**
         * Setup a viewModel on this view.
         * TODO : Update this to allow a viewModel to be passed in to override existing viewModel
         * @param {object} options - Backbone.View/View options (same parameters as used in initializaiton)
         */
        setViewModel: function(options) {
            this.viewModel = this.createViewModel(options);
            if (this.model) this.viewModel.model = (this.vm_context_model) ? this.vm_context_model : this.model;
        },

        /**
         * Applies knockout bindings if a model is present and they have not yet been applied.  If bindings have been applied
         * and this is being called again (for example on a re-render), the bindings will be reset.
         */
        renderBindings: function() {
            if (this.koBindingsApplied === false) {
                //Knockback initializes here
                if (!_.isEmpty(this.viewModel)) {
                    try {
                        ko.applyBindings(this.viewModel, this.$el[0]);
                    } catch (err) {
                        this.resetBindings();
                    }
                    this.koBindingsApplied = true;
                    kb.releaseOnNodeRemove(this.viewModel, this.$el[0]);
                    this.trigger('bindingsApplied', this);
                }
            } else {
                if (!_.isEmpty(this.viewModel)) {
                    this.resetBindings();
                    this.trigger('bindingsApplied', this);
                }
            }
        },


        // Validation 
        // ----------

        /**
         * Called to begin tracking client side validation for forms.  Uses jQuery Validate.
         * We can use this area to setup application wide validation rule defaults
         * extend one or the other (defaults or passed in rules) tbd
         * ref: http://jqueryvalidation.org/jQuery.validator.addClassRules/
         * @param {object} options - jQuery validate options
         */
        trackValidation: function(options) {
            // This can give us a common place to setup default validation options.
            options = (options) ? options : {};
            this.$el.find('form').validate(options);
        },

        // Primary Functions (for extending/overwriting)
        // ---------------------------------------------

        /**
         * This function creates the viewModel.  By default utilizes this._createViewModel, but should be
         * overwritten to accomodate the needs of the view.
         * @returns {object} viewModel or empty object if no model present (!this.model)
         * @param {object} options - options passed to the View
         */
        createViewModel: function(options) {
            if (this.model) return this._createViewModel(options);
            else return {};
        },

        /**
         * Placeholder function, designed to be overwritten to accomodate specific view needs.
         * This fires after the afterRender function fires (which applies view bindings)
         */
        renderComplete: function() {},

        /**
         * Placeholder function, designed to be overwritten to accomodate specific view needs.
         * This fires just before the view is actually rendered.
         */
        beforeRender: function() {},

        // Internal Functions/Helpers
        // --------------------------

        /**
         * Callback function to apply a retrieved entity as the model for this view.
         * Triggers this.afterRender().
         * @private
         * @param {object} data - JSON result object passed from breeze
         */
        _breezeCallback: function(data) {
            if (data.results) {
                this.setModel(data.results[0]);
                this.afterRender();
            }
        },

        /**
         * Updates this.model when this.vm_context_model is updated. Requires usage of nested model extension on this.model
         * @private
         * @param {object} event - Backbone.Model change event
         */
        _updateContextModel: function(event) {
            var vm_model_context = (_.isFunction(this.vm_model_context)) ? this.vm_model_context(this.model) : this.vm_model_context;
            var address = this._getAddress();
            var _this = this;
            //This shouldnt set change if the props are unchanged (initialization)
            if (address &amp;&amp; this.model &amp;&amp; _.isEqual(this.model.get(address), event.changed)) return false;
            $.each(event.changed, function(k, v) {
                if (_this.address &amp;&amp; _this.model) {
                    _this.model.set(address + '.' + k, v);
                } else vm_model_context[k] = v;
            });
        },

        /**
         * Listens for changes on this.model in order to apply updates to this.vm_context_model. Requires this.model to utilize backbone.nestedModel
         * @private
         * @param {object} event - Backbone.Model change event
         */
        _contextModelListen: function(event) {
            var address = this._getAddress();
            var changed = event.changedAttributes();
            var _this = this;
            for (var key in changed) {
                if (changed.hasOwnProperty(key)) {
                    if (key == address) {
                        var props = this.vm_context_model.attributes;
                        var changedAttributes = {};
                        $.each(changed[key], function(key, value) {
                            if (_this.exclusions.length &lt;= 0 || $.inArray(key, _this.exclusions) &lt; 0) {
                                if (_.isObject(value)) {
                                    if (!_.isEqual(value, props[key])) changedAttributes[key] = value;
                                } else {
                                    // Excluded props will by default not be recognized
                                    if (typeof props[key] != 'undefined' &amp;&amp; (value != props[key])) changedAttributes[key] = value;
                                }
                            }
                        });
                        if (!_.isEmpty(changedAttributes)) this.vm_context_model.set(changedAttributes);
                    }
                }
            }
        },

        /**
         * Helper for context view model to access the address property.
         * @private
         */
        _getAddress: function() {
            if (this.address) return (this.address &amp;&amp; _.isFunction(this.address)) ? this.address() : this.address;
            else return false;
        },

        /**
         * Recursive helper for this._createViewModel. Will look through passed in properties
         * to for simple arrays in order to set up proper knockback collectionObserveables.
         * @private
         * @param {string} key - The name of the property
         * @param {string} prop - The property to investigate
         * @param {object} viewModel - This viewModel
         * @param {string} traversed - Tracks properties that have been traversed (used within recursion only)
         */
        _createViewModelHelper: function(key, prop, viewModel, traversed) {
            if (!prop) return false;
            var attr, _this = this;

            // Is prop a collection? If so, investigate collection models for simple arrays.
            if (prop &amp;&amp; prop.models) {
                // Right now this will only go through backbone collections
                // until it is necessary we should skip queryengines - they should
                // not be used in a viewModel context (tentative)
                if (viewModel[key]().forEach) {
                    viewModel[key]().forEach(function(nestedViewModel) {
                        if (nestedViewModel.model) {
                            attr = nestedViewModel.model().attributes;
                            $.each(attr, function(key, value) {
                                _this._createViewModelHelper(key, value, nestedViewModel, traversed);
                            });
                        }
                    });
                }
            } else if (_.isArray(prop)) {
                // So the property is an array.  Setup a collection and subscriptions so we can have
                // a functional kb.collectionObserveable for our viewModel!
                var collection = new Backbone.Collection(prop);
                viewModel[key] = kb.collectionObservable(collection);

                if (prop.arrayChanged) {
                    prop.arrayChanged.subscribe(
                        function(arrayChangedArgs) {
                            var addedEntities = arrayChangedArgs.added;
                            if (addedEntities) {
                                collection.add(addedEntities);
                            }
                            var removedEntities = arrayChangedArgs.removed;
                            if (removedEntities) collection.remove(removedEntities);
                        });
                }

                // Now that we have that one setup, dig deeper!
                viewModel[key]().forEach(function(nestedViewModel) {
                    if (nestedViewModel.model) {
                        attr = nestedViewModel.model().attributes;
                        $.each(attr, function(key, value) {
                            _this._createViewModelHelper(key, value, nestedViewModel, traversed);
                        });
                    }
                });

            } else if (prop &amp;&amp; prop.attributes) {
                // This property is a model.  Track traversed so we dont get caught in an infinite loop for those entities with 
                // self-referencing properties.
                traversed = (traversed) ? traversed : [];
                if ($.inArray(prop.cid, traversed) &lt; 0) {
                    traversed.push(prop.cid);
                    // Go deeper into this nested model looking for simple arrays.
                    var nestedViewModel = (viewModel[key] &amp;&amp; viewModel[key].value &amp;&amp; _.isFunction(viewModel[key])) ? viewModel[key]() : viewModel[key];
                    if (nestedViewModel) {
                        $.each(prop.attributes, function(key, value) {
                            _this._createViewModelHelper(key, value, nestedViewModel, traversed);
                        });
                    }
                }
            }
        },

        /**
         * Default function for creating the viewModel.  Will convert this.model into a viewModel, converting any
         * simple arrays found into kb.collectionObserveables.
         * @private
         * @returns {object} ViewModel to be consumed by the view.
         * @param {object} [options] - Same initialization options passed to the view.  Also accepts Knockback options.
         * @param {object} [options.custom] - Key/value object with custom properties to be set on the viewModel
         */
        _createViewModel: function(options) {
            var model, _this = this;

            if (this.vm_model_context) {
                var vm_context_props = (_.isFunction(this.vm_model_context)) ? this.vm_model_context(this.model) : this.vm_model_context;
                // If the context model has not been setup yet, set it up with appropriate handlers
                if (!this.vm_context_model) {
                    this.vm_context_model = new Backbone.Model(vm_context_props);
                    // This will send updates to this.model
                    this.vm_context_model.on('change', this._updateContextModel);
                    // This will send this.model updates to this.vm_context_model
                    if (this.model) this.model.on('change', this._contextModelListen);
                    // More advanced option, pass in a references to related models
                    if (this.vm_model_context_options &amp;&amp; this.vm_model_context_options.related) {
                        for (var i = 0; i &lt; this.vm_model_context_options.related.length; i++) {
                            this.vm_model_context_options.related[i].on('change', function(e) {
                                _this._contextModelListen(e);
                            });
                        }
                    }
                } else {
                    // If the vm_context_model already exists, just re-populate it
                    this.vm_context_model.clear({
                        silent: true
                    });
                    this.vm_context_model.set(vm_context_props);
                }
                // Use this as the model to send to kb.viewModel()
                model = this.vm_context_model;
            } else {
                model = (this.model) ? this.model : null;
            }

            // Use the good ol' kb.ViewModel factory, passing in options
            var viewModel = kb.viewModel(model, options);

            // Helper below searches for nested arrays, creates backbone collectios
            // on those arrays to track changes, and creates viewModels from array models
            // - nested arrays are not by default handled by kb.viewModel (only bb collections)
            // - if the array is a breeze array, array update subscriptions are applied
            // - remember to apply array adds to the model property, not the viewModel array observable
            // TODO deprecate this.  It is too expensive as a default.  If the dev wants a trackable array, they can create that through utils and
            // add it to the viewModel.
            /*
            if (model) {
                $.each(model.attributes, function (key, value) {
                    _this._createViewModelHelper(key, value, viewModel);
                });
            }
            */

            // Setup custom properties on the viewModel if they have been passed in.
            // custom options passed as string (for property name) or {name:'string', value:val} 
            if (options &amp;&amp; options.custom) {
                for (var c = 0; c &lt; options.custom.length; c++) {
                    if (typeof options.custom[c] == 'string') viewModel[options.custom[c]] = ko.observable('');
                    else viewModel[options.custom[c].name] = ko.observable(options.custom[c].value);
                }
            }

            // Setup the reference to the viewModel and return it.
            this.viewModel = viewModel;
            return viewModel;
        },

        /**
         * References this._modelListeners to setup subscriptions on the model.
         * @private
         */
        _applyModelListeners: function() {
            if (this.model) {
                for (var i = 0; i &lt; this._modelListeners.length; i++) {
                    var listener = this._modelListeners[i];
                    this.model[listener.eventType](listener.trigger, listener.callback, listener.context);
                }
            }
        },

        /**
         * Helper function for renderBindings.  Utilizes ko.cleanNode to clear bindings on this view,
         * then re-delegates events and re-applies ko bindings.
         * @private
         */
        resetBindings: function() {
            try {
                // unbind events
                this.$el.find("*").each(function() {
                    $(this).unbind();
                });

                ko.cleanNode(this.$el[0]);
                // Need to reapply view events as cleanNode wipes those as well
                this.delegateEvents();
                if (!this.viewModel || this.viewModel.__kb_released === true) this.viewModel = this.createViewModel();
                ko.applyBindings(this.viewModel, this.$el[0]);
                kb.releaseOnNodeRemove(this.viewModel, this.$el[0]);
            } catch (err) {
                console.log(err);
            }
        },

        // Inherited from Backbone.LayoutManager
        // -------------------------------------

        /**
         * Function consumed by Backbone.Layout.  This function allows for a template
         * to be set as a string (ex: this.template = 'path/to/template.html')
         * @private
         * @param {string} path - the path to the template required
         */
        fetchTemplate: function(path) {
            var done = this.async();
            $.get(path, function(contents) {
                done(_.template(contents));
            }, "text");
        },

        /**
         * Inherited from Backbone.LayoutManager.  Applies knockout/event bindings.
         * Use this.renderComplete for custom after render functionality.
         * @private
         */
        afterRender: function() {
            this.renderBindings();
            this.renderComplete();
        }

    });

    return BaseView;
});</code></pre>
        </article>
    </section>





        

        <footer>
            Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha5</a> on Tue May 13 2014 13:18:45 GMT-0400 (Eastern Daylight Time)
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
<script src="scripts/main.js"></script>
</body>
</html>